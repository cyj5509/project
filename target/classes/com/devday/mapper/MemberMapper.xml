<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.devday.mapper.MemberMapper">

<!-- 회원가입: 나머지 컬럼들은 Default로 설정한 값들이 있어 따로 기입하지 않아도 됨 -->
<insert id="join" parameterType="com.devday.domain.MemberVO">
	INSERT INTO 
		member_tbl (
			mem_id, 
			mem_pw, 
			mem_name, 
			mem_phone, 
			mem_email, 
			mem_postcode, 
			mem_addr, 
			mem_deaddr
		)
		VALUES (
			#{mem_id}, 
			#{mem_pw}, 
			#{mem_name}, 
			#{mem_phone}, 
			#{mem_email}, 
			#{mem_postcode}, 
			#{mem_addr}, 
			#{mem_deaddr}
		)
</insert>

<!-- 아이디 중복검사: String mem_id를 이용해서 parameterType을  String으로 설정함 -->
<select id="idCheck" parameterType="String" resultType="String">
	SELECT
		mem_id
	FROM
		member_tbl
	WHERE
		mem_id = #{mem_id}
</select>

<!-- 로그인: 관리자/비관리자를 구분 짓기 위해  select문에 adm_check 컬럼 추가 -->
<select id="login" parameterType="String" resultType="com.devday.domain.MemberVO">
	select 
		mem_id, 
		mem_pw, 
		mem_name, 
		mem_phone, 
		mem_email, 
		mem_postcode, 
		mem_addr, 
		mem_deaddr, 
		mem_point, 
		mem_joindate, 
		mem_updatedate,
		mem_lastlogin,
		adm_check
	from 
		member_tbl 
	where 
		mem_id = #{mem_id}
</select>

<update id="loginTimeUpdate" parameterType="String">
	UPDATE
		member_tbl
	SET
		mem_lastlogin = sysdate
	WHERE
		mem_id = #{mem_id}
</update>

<update id="modify" parameterType="com.devday.domain.MemberVO">
	UPDATE
		member_tbl
	SET
		mem_email = #{mem_email}, 
		mem_phone = #{mem_phone},
		mem_postcode = #{mem_postcode}, 
		mem_addr = #{mem_addr}, 
		mem_deaddr = #{mem_deaddr},
		mem_updatedate = sysdate
	WHERE 
		mem_id = #{mem_id}
</update>

<delete id="delete" parameterType="String">
	DELETE FROM
		member_tbl
	WHERE 
		mem_id = #{mem_id}
</delete>



<select id="findIdByEmail" parameterType="String" resultType="String">
	SELECT
		mem_id
	FROM
		member_tbl
	WHERE
		mem_email = #{mem_email}
</select>

<select id="findPwByIdAndEmail" parameterType="map" resultType="String">
	 SELECT
	 	mem_pw
	 FROM
	 	member_tbl
	 WHERE
	 	mem_id = #{mem_id} AND mem_email = #{mem_email}
</select>

</mapper>  